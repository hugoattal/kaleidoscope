import{R as Y,v as re,d as M,k as z,u,q as g,S as ie,l as y,o as Z,D as ue,c as h,e as v,i as r,s as ce,T as G,x as de,g as b,J as T,G as H,H as ee,K as pe,z as ae,j as U,w as P,y as A,f as p,M as q,U as fe,F as L,B as J,V as Q,I as W}from"./index-BapYz_b6.js";import{_ as S,s as te}from"./_plugin-vue_export-helper-BhhpXjsj.js";import{a as j}from"./cache-pph6SkXW.js";function ve(l,a={}){let t=!0;a.fps??(a.fps=60);function d(){t=!1}let i=0,s=0;async function o(e){i||(i=e);const n=e-i;i=e,t&&(s+=n,s>1e3/a.fps&&(await l(s),s=0),requestAnimationFrame(o))}return requestAnimationFrame(o),d}const D=Y("kds-particle-speed","1"),E=Y("kds-background-color","#130505"),$=re({offline:!1}),_e=["height","width"],me=1/2e4,ye=1e3,he=5,ge=M({__name:"KBackground",props:{speed:{default:1}},setup(l){z(f=>({"71ab8e2c":u(E)}));const a=l,t=g(),d=g(),i=ie(d);let s;const o=y(()=>Math.min(ye,Math.floor(i.width.value*i.height.value*me)));Z(()=>{s=ve(e)}),ue(()=>{s()});function e(f){ne(),oe(f),le()}const n=[];function k(){return-Math.log(1-Math.random()*.99)*20+20}function I(){return-Math.log(1-Math.random()*.99)*.1+.1}function ne(){for(;n.length<o.value;)n.push({opacity:I(),radius:k(),x:Math.random(),y:Math.random()*2-.5});for(;n.length>o.value;)n.pop()}function oe(f){const x=he*a.speed*f*.06/i.height.value*D.value;for(const _ of n)_.y-=x/_.radius,_.y<-.5&&(_.y=1.5,_.x=Math.random(),_.radius=k(),_.opacity=I())}function le(){var O;const f=(O=t.value)==null?void 0:O.getContext("2d");if(!f)return;const x=t.value.width,_=t.value.height;f.clearRect(0,0,x,_);for(const m of n){const K=f.createRadialGradient(m.x*x,m.y*_,0,m.x*x,m.y*_,m.radius);K.addColorStop(0,`rgba(242, 146, 0, ${m.opacity*.6})`),K.addColorStop(.8,`rgba(242, 146, 0, ${m.opacity*.8})`),K.addColorStop(.9,`rgba(242, 146, 0, ${m.opacity})`),K.addColorStop(1,"rgba(242, 146, 0, 0)"),f.fillStyle="#f2920044",f.fillStyle=K,f.beginPath(),f.arc(m.x*x,m.y*_,m.radius,0,Math.PI*2),f.fill()}}return(f,x)=>(v(),h("div",{ref_key:"wrapper",ref:d,class:"canvas-wrapper"},[r("canvas",{ref_key:"canvas",ref:t,height:u(i).height.value,width:u(i).width.value},null,8,_e)],512))}}),we=S(ge,[["__scopeId","data-v-111142d9"]]),be=""+new URL("rockit-D1Fp-gcz.svg",import.meta.url).href,X=new Map;function ke(){for(const l of w.value){const a=l.album.images[0].url;if(!X.has(a)){const t=new Image;t.src=l.album.images[0].url,X.set(a,t)}}}const B=g([]),c=g(),w=g([]),V=g(0),se=g(0),F=g(!1),R=g(!1);async function C(){if(!F.value){F.value=!0;try{await xe()}finally{F.value=!1}}}async function xe(){var a,t,d;const l=await te("/me/player/queue");l.currently_playing&&((!c.value||c.value.id!==l.currently_playing.id)&&(c.value?B.value.push(c.value):B.value.length||(B.value=[l.currently_playing]),l.currently_playing.id===((a=w.value[0])==null?void 0:a.id)&&((t=l.queue[0])==null?void 0:t.id)===((d=w.value[1])==null?void 0:d.id)?(c.value=w.value.shift(),setTimeout(async()=>{await j(l.queue),w.value=l.queue},3e3)):(c.value=l.currently_playing,w.value=l.queue),await j([c.value,...w.value])),await Se(),se.value++,$.offline&&ke())}function Me(){w.value.length&&(c.value&&B.value.push(c.value),c.value=w.value.shift(),V.value=0)}async function Se(){const l=await te("/me/player");V.value=l.progress_ms}const $e={class:"playbar"},Ke={class:"remaining"},Te=M({__name:"KPlaybar",setup(l){z(e=>({"48db1a1e":s.value}));const a=g(0),t=g(0);ce(()=>[V.value,c.value,se.value],()=>{a.value=V.value,t.value=Date.now()},{immediate:!0});const d=y(()=>{const e=G({interval:1e3});return c.value.duration_ms-(a.value+(e.value-t.value))}),i=y(()=>{const e=Math.max(d.value,0),n=Math.floor(e/6e4),k=Math.floor(e%6e4/1e3);return`${n}:${k.toString().padStart(2,"0")}`}),s=y(()=>{const e=G({interval:1e3});return`${(a.value+(e.value-t.value))/c.value.duration_ms*100}%`});de(()=>d.value<=0,async()=>{if($.offline){Me(),await o(1e3),await C();return}const e=c.value.id;for(let n=0;n<5;n++){await o(1e3);try{if(await C(),c.value.id!==e)return}catch(k){console.warn("Failed to sync queue, retrying in 1s",k)}}});async function o(e=1e3){return new Promise(n=>setTimeout(n,e))}return(e,n)=>(v(),h("div",$e,[n[1]||(n[1]=r("div",{class:"cursor"},null,-1)),r("div",Ke,[r("span",null,T(i.value),1),n[0]||(n[0]=b(" restant "))])]))}}),Be=S(Te,[["__scopeId","data-v-69a9d4a2"]]),Ce={class:"feature-display"},Ie=M({__name:"KFeatureDisplay",props:{colorMax:{},colorMin:{},max:{default:1},min:{default:0},steps:{default:5},value:{}},setup(l){z(e=>({"7d80deb9":s.value}));const a=l,t=y(()=>Math.min(Math.max((a.value-a.min)/(a.max-a.min),1e-4),.9999)),d=y(()=>Array.from({length:a.steps},(e,n)=>({display:n<a.steps*t.value?1:0}))),i=["#5555ff","#419bcc","#1cb374","#4dc116","#fffe00"],s=y(()=>{const e=Math.floor(a.steps*t.value);return i[e]}),o=y(()=>t.value>.8);return(e,n)=>(v(),h("div",Ce,[(v(!0),h(H,null,ee(d.value,(k,I)=>(v(),h("div",{key:I,class:ae(["value",{shiny:o.value}]),style:pe({opacity:k.display})},null,6))),128))]))}}),N=S(Ie,[["__scopeId","data-v-518a9ecf"]]),Pe={class:"cover"},De=["src"],Ee={class:"content"},Fe={class:"title",translate:"no"},Ve={class:"name"},qe={class:"artist"},Le={key:0,class:"features"},Ne={class:"feature-wrapper"},Ae={class:"label"},Re={class:"feature-wrapper"},ze={class:"label"},He={class:"feature-wrapper"},Oe={class:"label"},Ge={class:"description"},Ue=M({__name:"KTracklist",setup(l){const a=y(()=>B.value.at(-1)),t=y(()=>w.value.slice(0,3)),d=y(()=>{const i=[];a.value&&i.push({type:"last",data:a.value,description:"Dernière"}),c.value&&i.push({type:"current",data:c.value,description:"En cours"});for(const[s,o]of t.value.entries())i.push({type:"next",data:o,description:`Prochaine ${s+1}`});return i});return(i,s)=>(v(),U(fe,{class:"tracklist",name:"list",tag:"div"},{default:P(()=>[(v(!0),h(H,null,ee(d.value,o=>{var e;return v(),h("div",{key:o.data.id,class:ae(["track",o.type])},[r("div",Pe,[r("img",{alt:"Album cover",src:(e=o.data.album.images[0])==null?void 0:e.url},null,8,De)]),r("div",Ee,[r("div",Fe,[r("span",Ve,T(o.data.name),1),s[0]||(s[0]=b(" (")),r("span",qe,T(o.data.artists[0].name),1),s[1]||(s[1]=b(") "))]),o.data.features?(v(),h("div",Le,[r("div",Ne,[r("div",Ae,[p(u(q),{class:"icon",icon:"speed"}),r("span",null,[s[2]||(s[2]=b("Tempo (")),r("strong",null,T(Math.round(o.data.features.tempo)),1),s[3]||(s[3]=b(" BPM)"))])]),p(N,{class:"feature",max:160,min:80,value:o.data.features.tempo},null,8,["value"])]),r("div",Re,[r("div",ze,[p(u(q),{class:"icon",icon:"trending_up"}),s[4]||(s[4]=r("span",null,"Popularité",-1))]),p(N,{class:"feature",value:o.data.popularity/100},null,8,["value"])]),r("div",He,[r("div",Oe,[p(u(q),{class:"icon",icon:"bolt"}),s[5]||(s[5]=r("span",null,"Énergie",-1))]),p(N,{class:"feature",value:o.data.features.energy},null,8,["value"])])])):A("",!0),o.type==="current"?(v(),U(Be,{key:1})):A("",!0)]),r("div",Ge,T(o.description),1)],2)}),128))]),_:1}))}}),Je=S(Ue,[["__scopeId","data-v-9773f422"]]),Qe={class:"menu"},We=M({__name:"KPlayerMenu",setup(l){async function a(){await C()}async function t(){if($.offline){$.offline=!1;return}$.offline=!0,await C()}function d(){R.value=!R.value}const i=[{id:"0",icon:"stop",label:"Stop"},{id:"1",icon:"play_arrow",label:"Normal"},{id:"2",icon:"fast_forward",label:"Fast"}],s=[{id:"#1c0b0b",icon:"light_mode",label:"Normal"},{id:"#130505",icon:"cloud",label:"Dark"},{id:"#000000",icon:"dark_mode",label:"Darker"}];return(o,e)=>(v(),h("div",Qe,[p(u(L),{icon:"event",onClick:d},{default:P(()=>e[2]||(e[2]=[b(" Toggle event ")])),_:1}),p(u(J),{modelValue:u(E),"onUpdate:modelValue":e[0]||(e[0]=n=>Q(E)?E.value=n:null),options:s},null,8,["modelValue"]),p(u(J),{modelValue:u(D),"onUpdate:modelValue":e[1]||(e[1]=n=>Q(D)?D.value=n:null),options:i},null,8,["modelValue"]),p(u(L),{icon:"refresh",onClick:a,disabled:u(F)},{default:P(()=>e[3]||(e[3]=[b(" Manual sync ")])),_:1},8,["disabled"]),p(u(L),{icon:"refresh",onClick:t,type:u($).offline?u(W).Primary:u(W).Default},{default:P(()=>e[4]||(e[4]=[b(" Offline sync ")])),_:1},8,["type"])]))}}),je=S(We,[["__scopeId","data-v-65ce0e8d"]]),Xe={key:0,class:"events"},Ye=M({__name:"KEvents",setup(l){return(a,t)=>u(R)?(v(),h("div",Xe,t[0]||(t[0]=[b(" Inscrivez-vous au "),r("span",{class:"title"},"Summer Danse Festival",-1),b(" Samedi 14 Juin 2025 "),r("span",{class:"description"},"4 salles, plus de 700m², cours, soirée, shows...",-1)]))):A("",!0)}}),Ze=S(Ye,[["__scopeId","data-v-1ed6cc82"]]),ea={class:"content"},aa=["src"],ta=M({__name:"KPlayerLayout",setup(l){return Z(async()=>{await C()}),(a,t)=>(v(),h(H,null,[p(we,{class:"bokeh"}),p(Ze),p(je),r("div",ea,[r("img",{alt:"RockIt Logo",class:"logo",src:u(be)},null,8,aa),p(Je)])],64))}}),la=S(ta,[["__scopeId","data-v-5736862e"]]);export{la as default};
